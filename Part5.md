# ЧАСТЬ V Получение работы

<!-- TOC -->

- [ЧАСТЬ V Получение работы](#часть-v-получение-работы)
    - [Глава 23. Лучшие практические советы по программированию](#глава-23-лучшие-практические-советы-по-программированию)
        - [Написание кода — крайнее средство](#написание-кода--крайнее-средство)
        - [НПС (DRY)](#нпс-dry)
        - [Ортогональность](#ортогональность)
        - [У каждого фрагмента данных должно быть одно представление](#у-каждого-фрагмента-данных-должно-быть-одно-представление)
        - [У функции должна быть одна задача](#у-функции-должна-быть-одна-задача)
        - [Если на это уходит много времени, вероятно, вы совершаете ошибку](#если-на-это-уходит-много-времени-вероятно-вы-совершаете-ошибку)
        - [Делайте все самым лучшим способом](#делайте-все-самым-лучшим-способом)
        - [Соблюдайте соглашения](#соблюдайте-соглашения)
        - [Используйте мощную IDE](#используйте-мощную-ide)
        - [Логирование](#логирование)
        - [Тестирование](#тестирование)
        - [Анализ кода](#анализ-кода)
        - [Безопасность](#безопасность)
        - [Словарь терминов Глава 23](#словарь-терминов-глава-23)

<!-- /TOC -->

## Глава 23. Лучшие практические советы по программированию

> Всегда пишите код так, будто сопровождать его будет
> склонный к насилию психопат, который знает, где вы живете.
> *Джон Вудс*

**Производственный код** — это код используемого людьми продукта. Отправить программное обеспечение в **производство** — значит вывести его в мир. Многие из этих принципов были описаны в «Программисте-прагматике», книге Энди Ханта и Дейва Томаса, которая значительно улучшила качество моего кода.

### Написание кода — крайнее средство

Ваша работа как инженера-программиста заключается в том, чтобы писать как можно меньше кода. Когда у вас возникает проблема, вашей первой мыслью должно быть не «*Как я могу решить ее?*», а «*Решил ли уже кто-то эту проблему, и если да, то могу ли я использовать это решение?*». Если вы пытаетесь решить распространенную проблему, есть высокий шанс, что кто-то уже в ней разобрался. Начните с поиска решения онлайн, и только после того, как выяснится, что вашу проблему еще никто не решил, сами приступайте к решению.

### НПС (DRY)

НПС (Не повторяй себя) — это принцип программирования, согласно которому в программе не следует повторно использовать один и тот же или сильно похожий код. Вместо этого нужно поместить код в одну функцию, обрабатывающую множество ситуаций.

### Ортогональность

**Ортогональность** — еще один важный программистский принцип, ставший известным благодаря книге «Программист-прагматик». Хант и Томас дают такое объяснение: «Этот термин был введен в информатике для обозначения некой разновидности независимости или несвязанности. Два или более объекта ортогональны, если изменения, вносимые в один из них, не влияют на любой другой. В грамотно спроектированной системе код базы данных будет ортогональным к интерфейсу пользователя: вы можете менять интерфейс пользователя без воздействия на базу данных и менять местами базы данных, не меняя интерфейса». Чтобы применить этот принцип на практике, хорошенько запомните, что «A не должно влиять на Б». Если у вас есть два модуля, `module a` и `module b`, то `module a` не должен вносить изменения в `module b` и наоборот. Если вы спроектируете систему, где A влияет на Б, Б влияет на В, В влияет на Г, — все очень быстро выйдет из-под контроля и система станет неуправляемой.

### У каждого фрагмента данных должно быть одно представление

Один фрагмент данных следует хранить в одном месте. Скажем, вы разрабатываете программное обеспечение, обрабатывающее телефонные номера. Если у вас есть две функции, использующие список кодов регионов, проследите, чтобы все коды были помещены в один список — не должно быть двух дублирующих друг друга списков для каждой функции. Используйте глобальную переменную, которая будет хранить коды регионов. Или еще лучше, храните данные в файле или базе данных.  
Проблема дублирования данных в том, что на определенном этапе вам понадобится изменить эти данные. Тогда вам придется вспоминать все места с дубликатами, чтобы изменить также и их. Если вы измените список кодов регионов в одной функции и забудете о другой, ваша программа не будет работать должным образом. Этого можно избежать, если у каждого фрагмента данных будет одно представление.

### У функции должна быть одна задача

У каждой написанной вами функции должна быть одна, и только одна, задача. Если вам покажется, что функции становятся слишком длинными, спросите себя — возможно, они выполняют больше одной задачи? Ограничение функций на выполнение одной задачи дает несколько преимуществ. Код будет легче читаться, ведь имя вашей функции укажет именно на то, чем она занимается. Если код не работает, то будет легче осуществить отладку — поскольку когда каждая функция отвечает за конкретную задачу, их можно быстро изолировать и определить, какая из них не работает. Как говорили многие известные программисты; «*Столько сложностей в программном обеспечении происходит от попыток заставить одну вещь делать две вещи*».

### Если на это уходит много времени, вероятно, вы совершаете ошибку

Если вы не работаете над чем-то очевидно сложным и не работаете с огромным количеством данных, а ваша программа очень долго загружается, вероятно, вы делаете что-то не так.

### Делайте все самым лучшим способом

Если в процессе программирования вы подумали: «Я знаю, что существует лучший способ сделать это, но я уже не хочу останавливаться и выяснять, как это сделать», не продолжайте кодинг. Остановитесь. Вы должны сделать это лучшим способом.

### Соблюдайте соглашения

Если вы потратите время на изучение соглашений нового языка программирования, то сможете быстрее читать код на этом языке. PEP 8 представляет собой сборник методических рекомендаций по написанию кода на Python — ознакомьтесь с ним. Там есть правила по переносу кода на новые строки. На русском языке документ PEP 8 доступен по адресу <https://pythonworld.ru/osnovy/pep-8-rukovodstvo-po-napisaniyu-koda-na-python.html>.

### Используйте мощную IDE

Если вы хотите научиться пользоваться PyCharm, на сайте JetBrains есть руководство, доступное по адресу <http://www.jetbrains.com/help/pycharm/quick-start-guide.html>.

### Логирование

Логирование — это практика записи данных во время работы программного обеспечения. Логирование можно использовать для отладки программы и получения дополнительной информации о том, что происходило во время работы вашей программы. Python поставляется с модулем `logging`, позволяющим записывать процессы работы в консоль или файл.  
Когда что-то в вашей программе работает неправильно, нельзя оставлять это без внимания — нужно запротоколировать информацию о случившемся, чтобы изучить ее позже. Логирование также полезно при сборе и анализе данных. Например, можно настроить веб-сервер , чтобы он производил журналирование данных, включая дату и время, каждый раз, как он получает запрос. Все ваши журналы нужно сохранить в базе данных и создать программу для анализа этих данных, построив граф, отображающий количество посещений вашего сайта в день.  
Блогер Хенрик Варне пишет: «*Одно из отличий хорошего программиста от плохого заключается в том, что хороший программист использует логирование, а также другие инструменты, позволяющие с легкостью отладить программу, когда все рушится*». О том, как использовать модуль logging, можно прочесть на сайте <https://docs.python.org/3/howto/logging.html>.

### Тестирование

Под тестированием программы подразумевается процесс проверки того, что она «соответствует требованиям, сопровождавшим ее проектирование и разработку, корректно отвечает на все виды ввода, выполняет свои функции за приемлемое количество времени, пригодна к использованию, может быть установлена и запущена в предполагаемых окружениях, а также достигает результата, требуемого от нее заинтересованными сторонами». Для тестирования своих программ программисты пишут другие программы.  
В производстве тестирование является обязательным. Ни одна программа, отправляемая в производство, не может считаться полноценной до тех пор, пока для нее не будут написаны тесты. Впрочем, если вы написали небольшую программу, которую больше не собираетесь использовать, ее тестирование может быть тратой времени. Если же вы пишете программы, которые будут использоваться другими людьми, вы обязаны написать тесты. Как говорили некоторые известные программисты, «*Непротестированный код — нерабочий код*». Узнайте, как использовать модуль Python `unittest` на странице <https://docs.python.org/3/library/unittest.html>.

### Анализ кода

При анализе кода кто-либо читает ваш код и составляет на него отзыв. Следует делать столько обзоров кода, сколько возможно — особенно если вы программист-самоучка. Даже если вы последуете всем советам, изложенным в этой главе, вы все равно будете делать что-то неправильно. Нужно, чтобы кто-то опытный прочел ваш код и указал на ошибки, которые вы затем устраните.  
`Code Review` — сайт, где можно провести анализ кода сообществом программистов. Любой желающий может зайти на `Code Review` и опубликовать свой код; другие участники сообщества `Stack Exchange` просматривают этот код, составляют отзыв, указывая, что было сделано хорошо, и предлагают полезные советы по его улучшению. Посетите Code Review по адресу <https://codereview.stackexchange.com/>.

### Безопасность

Программисты-самоучки часто игнорируют тему безопасности. Скорее всего, на собеседованиях вас не будут спрашивать об этом; безопасность не важна для программ, которые вы пишете во время обучения. Однако, как только вы получите свою первую должность, вы будете непосредственно ответственны за безопасность вашего кода.  
Ранее вы научились использовать команду `sudo` для работы от имени суперпользователя. Никогда не запускайте программу из командной строки, используя `sudo`, если в этом нет необходимости, поскольку если программа будет скомпрометирована, хакер получит доступ к правам `root`. Также, если вы управляете веб-сервером, следует отключить возможность входа в систему от имени суперпользователя. Все хакеры знают о существовании учетной записи суперпользователя, так что при атаке на систему это будет легкая цель.  
Никогда не забывайте, что ввод пользователя может быть вредоносным. Несколько видов вредоносных атак построены на эксплойтах, использующих ввод, поэтому нужно исходить из того, что ввод всех пользователей вредоносен, и программировать в соответствии с этим.  
Еще одной стратегией поддержки вашего программного обеспечения в безопасности может считаться минимизирование **поверхности атаки** — различных областей программы, откуда хакеры могут извлечь данные или атаковать вашу систему. Уменьшая поверхность атаки, вы снижаете вероятность появления в вашей программе уязвимостей. Далее перечислю несколько стратегий по уменьшению поверхности атаки: не храните конфиденциальные данные без необходимости; предоставляйте пользователям самый низкий уровень доступа из возможных; используйте как можно меньше сторонних библиотек (меньше кода, меньше эксплойтов); избавьтесь от возможностей, которые больше не используются.  
Отключение функции авторизации от имени суперпользователя, настороженное отношение к пользовательскому вводу, минимизирование поверхности атаки — важные шаги на пути к обеспечению безопасности программ. Но это только начало. Всегда пытайтесь думать как злоумышленник. Как бы он смог использовать ваш код в своих интересах? Такой способ мышления поможет найти уязвимости, которые иначе вы могли проглядеть. Аспектов, касающихся безопасности, существует куда больше, чем я смогу раскрыть в этой книге, так что непрерывно размышляйте о безопасности и изучайте ее. Брюс Шнайер сказал лучше всех: «*Безопасность — это состояние души*».

### Словарь терминов Глава 23

**Анализ кода:** когда другой программист читает ваш код и составляет на него отзыв.  
**Логирование:** практика записи данных во время работы программного обеспечения.  
**НПС:** принцип программирования «Не повторяй себя».  
**Ортогональность:** «Этот термин был введен в информатике для обозначения некой разновидности независимости или несвязанности. Два или более объекта ортогональны, если изменения, вносимые в один из них, не влияют на любой другой. В грамотно спроектированной системе код базы данных будет ортогональным к интерфейсу пользователя: вы можете менять интерфейс пользователя без воздействия на базу данных и менять местами базы данных, не меняя интерфейса».  
**Отладчик:** программа, позволяющая остановить выполнение кода и просмотреть вашу программу строка за строкой, отмечая значения переменных в разных частях программы.  
**Поверхность атаки:** различные области программы, откуда хакеры могут извлечь данные или атаковать вашу систему.  
**Производственный код:** код используемого людьми продукта.  
**Производство:** отправить программное обеспечение в производство — значит вывести его в мир.  
**Тестирование:** процесс проверки того, что программа «соответствует требованиям, сопровождавшим ее проектирование и разработку, корректно отвечает на все виды ввода, выполняет свои функции за приемлемое количество времени, пригодна к использованию, может быть установлена и запущена в предполагаемых окружениях, а также достигает результата, требуемого от нее заинтересованными сторонами».